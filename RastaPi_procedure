### Burn image using
###
https://archlinuxarm.org/platforms/armv8/broadcom/raspberry-pi-4


### log in as root
###
su root     =>  root


### Init Pacman & update
###
pacman-key --init
pacman-key --populate archlinuxarm
pacman -Syu


### Change root password
###
passwd   =>   rootpi


### enable SSH root login
###
nano /etc/ssh/sshd_config
=> PermitRootLogin yes 
systemctl restart sshd


### generate rpi ssh keys
###
ssh-keygen  => no password


### copy remote ssh key to rpi
###
[from remote machine] ssh-copy-id root@<IP-ADDRESS>


### remove alarm
###
userdel -r alarm


### install some stuffs
###
pacman -S git python python-pip python-setuptools


### switch from netctl to NetworkManager
###
pacman -S networkmanager
pacman -R dhcpcd
nano /etc/hostname   
=>  rastapi
nano /etc/NetworkManager/NetworkManager.conf
=>  
    [main]
    plugins=keyfile

systemctl enable NetworkManager
systemctl start NetworkManager
nmcli con add type ethernet con-name eth0-dhcp ifname eth0
pacman -R netctl


### clone RPi-tools
###
cd /root
git clone https://github.com/KomplexKapharnaum/RPi-tools.git


### copy config.txt
### (check if there is no new config.txt settings that you should keep)
###
cp /root/RPi-tools/config.txt /boot/config.txt
reboot


### dynhost
###
ln -s /root/RPi-tools/dynhost/dynhost.service /etc/systemd/system/dynhost.service
systemctl enable dynhost
systemctl start dynhost


### audioselect 
### (needs dtparam=audio=on inf /boot/config.txt)
###
pacman -S alsa alsa-utils
cp /root/RPi-tools/audioselect/asound.conf /etc/asound.conf
ln -s /root/RPi-tools/audioselect/audioselect.service /etc/systemd/system/audioselect.service
systemctl enable audioselect
systemctl start audioselect


### starter
###
pacman -S python-pydbus
ln -s /root/RPi-tools/starter/starter.service /etc/systemd/system/starter.service
systemctl enable starter
systemctl start starter


### usbmount
###
mkdir /mnt/usb
ln -s /root/RPi-tools/usbmount/mnt-usb.mount /etc/systemd/system/mnt-usb.mount
systemctl enable mnt-usb.mount


### network-magickey
### 
(not sure how to enable)


### rorw
###





